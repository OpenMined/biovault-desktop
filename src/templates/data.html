<div class="view-container">
	<!-- Page Header -->
	<header class="page-header">
		<div class="page-header-left">
			<div class="page-header-title-row">
				<h1 class="page-title">Data</h1>
				<span id="file-count" class="page-count-badge">0</span>
			</div>
			<p class="page-subtitle">Imported genotype files and analysis results</p>
		</div>
		<div class="page-header-right">
			<!-- Data view toggle -->
			<div class="pill-toggle pill-toggle-lg" id="data-view-toggle">
				<button class="pill-button active" data-view="participants">Files</button>
				<button class="pill-button" data-view="datasets">Datasets</button>
			</div>

			<!-- Search -->
			<div class="page-header-search">
				<svg
					width="15"
					height="15"
					viewBox="0 0 24 24"
					fill="none"
					stroke="currentColor"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
				>
					<circle cx="11" cy="11" r="8"></circle>
					<line x1="21" y1="21" x2="16.65" y2="16.65"></line>
				</svg>
				<input type="text" id="file-search" placeholder="Search files..." />
			</div>

			<!-- Selection Actions (hidden by default) -->
			<div class="selection-actionsmodern" style="display: none" id="selection-actions-group">
				<span class="selection-count-text" id="selection-count-text">0</span>
				<button
					id="delete-selected-btn"
					class="btn-icon btn-icon-small"
					title="Delete selected files"
				>
					<svg
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
					>
						<polyline points="3 6 5 6 21 6"></polyline>
						<path
							d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
						></path>
					</svg>
				</button>
			</div>

			<!-- Queue Controls -->
			<div class="queue-cardmodern" id="queue-card-container" style="display: none">
				<button id="process-queue-btn" class="btn-action" title="Toggle queue processing">
					<span id="queue-btn-icon-container" class="queue-icon-wrapper"></span>
					<span id="queue-btn-text" class="queue-btn-label">Resume</span>
				</button>
				<div class="queue-statusmodern" id="queue-status-indicator" style="display: none">
					<div class="queue-status-content">
						<span id="queue-spinner-container" class="queue-spinner-wrapper" style="display: none">
							<svg width="12" height="12" viewBox="0 0 24 24" class="queue-spinner-svg">
								<circle
									cx="12"
									cy="12"
									r="10"
									stroke="currentColor"
									stroke-width="2"
									fill="none"
									opacity="0.25"
								/>
								<path
									d="M12 2 A10 10 0 0 1 22 12"
									stroke="currentColor"
									stroke-width="2"
									fill="none"
									stroke-linecap="round"
								/>
							</svg>
						</span>
						<span id="pending-count" class="queue-count">0</span>
						<span class="queue-time-estimate" id="queue-time-estimate-display"></span>
					</div>
				</div>
				<button
					id="clear-queue-btn"
					class="btn-icon btn-icon-small"
					title="Clear all pending files"
					style="display: none"
				>
					<svg
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
					>
						<line x1="18" y1="6" x2="6" y2="18"></line>
						<line x1="6" y1="6" x2="18" y2="18"></line>
					</svg>
				</button>
			</div>

			<!-- Primary Actions -->
			<div class="page-header-actions">
				<button id="run-analysis-btn" class="btn-action" title="Select files to run pipeline">
					<svg
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
					>
						<polygon points="5 3 19 12 5 21 5 3"></polygon>
					</svg>
					<span id="run-analysis-text">Run Pipeline</span>
				</button>
				<button id="open-import-modal-btn" class="btn-primary">
					<svg
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
					>
						<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
						<polyline points="7 10 12 15 17 10"></polyline>
						<line x1="12" y1="15" x2="12" y2="3"></line>
					</svg>
					<span>Import</span>
				</button>
			</div>
		</div>
	</header>

	<!-- Main Content -->
	<div class="view-content">
		<div class="data-container">
			<!-- Participants-focused table (existing) -->
			<div class="data-main-layout" id="participant-data-section">
				<div class="files-panel">
					<div class="files-table-wrapper">
						<table class="files-table">
							<thead>
								<tr>
									<th class="col-checkbox">
										<input
											type="checkbox"
											id="select-all-data-files"
											title="Select all visible files"
										/>
									</th>
									<th class="col-participant sortable-header" data-sort-field="participant_id">
										Participant
										<span class="sort-indicator"></span>
									</th>
									<th class="col-status sortable-header" data-sort-field="status">
										Status
										<span class="sort-indicator"></span>
									</th>
									<th class="col-file sortable-header" data-sort-field="file_path">
										File
										<span class="sort-indicator"></span>
									</th>
									<th class="col-type sortable-header" data-sort-field="data_type">
										Type
										<span class="sort-indicator"></span>
									</th>
									<th class="col-source sortable-header" data-sort-field="source">
										Source
										<span class="sort-indicator"></span>
									</th>
									<th class="col-grch sortable-header" data-sort-field="grch_version">
										GRCh
										<span class="sort-indicator"></span>
									</th>
									<th class="col-rows sortable-header" data-sort-field="row_count">
										Rows
										<span class="sort-indicator"></span>
									</th>
									<th class="col-sex sortable-header" data-sort-field="inferred_sex">
										Sex
										<span class="sort-indicator"></span>
									</th>
									<th class="col-actions">Actions</th>
								</tr>
							</thead>
							<tbody id="files-table-body"></tbody>
						</table>
					</div>

					<div id="files-empty-state" class="files-empty-state" style="display: none">
						<svg width="64" height="64" viewBox="0 0 16 16" fill="currentColor" opacity="0.2">
							<path
								d="M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1H5z"
							/>
							<path
								d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"
							/>
						</svg>
						<h3 id="empty-state-title">No files found</h3>
						<p id="empty-state-message">Try adjusting your filters or search term</p>
					</div>
				</div>
			</div>

			<!-- Data-focused datasets panel -->
			<div class="data-main-layout" id="dataset-data-section" style="display: none">
				<div class="files-panel">
					<div
						class="panel-header"
						style="display: flex; justify-content: space-between; align-items: center; gap: 12px"
					>
						<div>
							<h3 class="panel-title" style="margin: 0">Datasets</h3>
							<p class="panel-subtitle" style="margin: 2px 0 0; color: var(--muted-text)">
								Manage dataset manifests, assets, and publishing to your datasite
							</p>
						</div>
						<div class="panel-actions" style="display: flex; gap: 8px">
							<button id="refresh-datasets-btn" class="btn-icon" title="Reload datasets">
								<img src="assets/icons/rerun.svg" width="16" height="16" alt="Reload" />
							</button>
							<button id="new-dataset-btn" class="btn-primary">New Dataset</button>
						</div>
					</div>

					<div class="datasets-table-wrapper">
						<table class="files-table datasets-table">
							<thead>
								<tr>
									<th>Name</th>
									<th>Version</th>
									<th>Author</th>
									<th>Schema</th>
									<th>Assets</th>
									<th>Published</th>
									<th class="col-actions">Actions</th>
								</tr>
							</thead>
							<tbody id="datasets-table-body"></tbody>
						</table>
					</div>

					<div id="datasets-empty-state" class="files-empty-state" style="display: none">
						<svg width="64" height="64" viewBox="0 0 16 16" fill="currentColor" opacity="0.2">
							<path d="M4 2h8a2 2 0 0 1 2 2v8.5l-3-2-3 2-3-2-3 2V4a2 2 0 0 1 2-2z" />
						</svg>
						<h3>No datasets found</h3>
						<p>Create a dataset or publish one from the CLI to see it here.</p>
					</div>
				</div>
			</div>

			<!-- Dataset editor view -->
			<div class="data-main-layout" id="dataset-editor-section" style="display: none">
				<div class="files-panel">
					<div
						class="panel-header"
						style="display: flex; justify-content: space-between; align-items: center; gap: 12px"
					>
						<div>
							<h3 class="panel-title" id="dataset-editor-title" style="margin: 0">New Dataset</h3>
							<p class="panel-subtitle" style="margin: 2px 0 0; color: var(--muted-text)">
								Define dataset metadata and assets
							</p>
						</div>
						<div class="panel-actions" style="display: flex; gap: 8px">
							<button id="dataset-editor-cancel" class="btn-secondary" type="button">Back</button>
							<button id="dataset-editor-save" class="btn-primary" type="button">Save</button>
						</div>
					</div>

					<div class="dataset-editor-body">
						<div class="form-row">
							<label for="dataset-form-name">Name</label>
							<input
								id="dataset-form-name"
								type="text"
								placeholder="single_cell"
								autocapitalize="off"
								autocorrect="off"
								spellcheck="false"
							/>
						</div>
						<div class="form-row">
							<label for="dataset-form-description">Description</label>
							<textarea
								id="dataset-form-description"
								rows="2"
								placeholder="Short summary"
								autocapitalize="off"
								autocorrect="off"
								spellcheck="false"
							></textarea>
						</div>
						<div class="form-grid">
							<div class="form-row">
								<label for="dataset-form-author">Author</label>
								<input
									id="dataset-form-author"
									type="text"
									placeholder="you@example.com"
									autocapitalize="off"
									autocorrect="off"
									spellcheck="false"
								/>
							</div>
							<div class="form-row">
								<label for="dataset-form-version">Version</label>
								<input
									id="dataset-form-version"
									type="text"
									placeholder="1.0.0"
									autocapitalize="off"
									autocorrect="off"
									spellcheck="false"
								/>
							</div>
							<div class="form-row">
								<label for="dataset-form-schema">Schema</label>
								<input
									id="dataset-form-schema"
									type="text"
									placeholder="net.biovault.datasets:1.0.0"
									value="net.biovault.datasets:1.0.0"
									disabled
								/>
							</div>
						</div>

						<div class="form-row" style="margin-top: 12px">
							<div
								style="display: flex; align-items: center; justify-content: space-between; gap: 8px"
							>
								<label>Assets</label>
								<button id="dataset-form-add-asset" class="btn-secondary" type="button">
									Add Asset
								</button>
							</div>
							<div id="dataset-form-assets" class="asset-rows"></div>
						</div>
					</div>
				</div>
			</div>

			<!-- Dataset modal -->
			<div id="dataset-modal" class="modal" style="display: none">
				<div class="modal-overlay"></div>
				<div class="modal-content" style="max-width: 720px">
					<div class="modal-header">
						<h3 id="dataset-modal-title">New Dataset</h3>
						<button id="dataset-modal-close" class="btn-icon" aria-label="Close">
							<img src="assets/icons/x.svg" width="16" height="16" alt="Close" />
						</button>
					</div>
					<div class="modal-body">
						<div class="form-row">
							<label for="dataset-name">Name</label>
							<input id="dataset-name" type="text" placeholder="single_cell" />
						</div>
						<div class="form-row">
							<label for="dataset-description">Description</label>
							<textarea id="dataset-description" rows="2" placeholder="Short summary"></textarea>
						</div>
						<div class="form-grid">
							<div class="form-row">
								<label for="dataset-author">Author</label>
								<input id="dataset-author" type="text" placeholder="you@example.com" />
							</div>
							<div class="form-row">
								<label for="dataset-version">Version</label>
								<input id="dataset-version" type="text" placeholder="1.0.0" />
							</div>
							<div class="form-row">
								<label for="dataset-schema">Schema</label>
								<input id="dataset-schema" type="text" placeholder="net.biovault.datasets:1.0.0" />
							</div>
						</div>

						<div class="form-row" style="margin-top: 12px">
							<div
								style="display: flex; align-items: center; justify-content: space-between; gap: 8px"
							>
								<label>Assets</label>
								<button id="add-asset-row" class="btn-secondary" type="button">Add Asset</button>
							</div>
							<div id="dataset-assets" class="asset-rows"></div>
						</div>
					</div>
					<div class="modal-footer" style="display: flex; justify-content: flex-end; gap: 8px">
						<button id="dataset-cancel" class="btn-secondary" type="button">Cancel</button>
						<button id="dataset-save" class="btn-primary" type="button">Save Dataset</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Global Empty State (no data at all) -->
		<div id="data-empty-state" class="empty-state" style="display: none">
			<svg width="64" height="64" viewBox="0 0 16 16" fill="currentColor" opacity="0.3">
				<path
					d="M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"
				/>
			</svg>
			<h3>No data imported yet</h3>
			<p>Click "Import Data" to add your first genotype file</p>
		</div>
	</div>
</div>
