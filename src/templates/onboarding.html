<div class="onboarding-view">
	<div class="onboarding-card" style="max-width: 700px">
		<!-- Step 1: Welcome -->
		<div id="onboarding-step-1" class="onboarding-step" style="display: block">
			<h1>Welcome to BioVault</h1>
			<p>Let's get your system setup.</p>
			<button id="onboarding-next-1" class="btn-primary onboarding-btn">Next →</button>
		</div>

		<!-- Step 2: Dependencies -->
		<div id="onboarding-step-2" class="onboarding-step" style="display: none">
			<div class="onboarding-step-header">
				<h1>Configure Your System</h1>
				<button id="skip-dependencies-btn" class="btn-secondary onboarding-skip-btn">Skip</button>
			</div>
			<p class="onboarding-step-description">
				BioVault requires the following dependencies. You can ask BioVault to attempt installation
				for you or manually install the missing dependencies yourself and click 'Check Again' after.
			</p>

			<!-- Two-panel layout -->
			<div class="onboarding-deps-panels">
				<!-- Left panel: Dependencies list -->
				<div id="deps-list" class="onboarding-deps-list">
					<!-- Dependencies will be populated here -->
					<div class="onboarding-loading">
						<div class="spinner" style="width: 24px; height: 24px; margin: 0 auto 15px"></div>
						<p>Checking...</p>
					</div>
				</div>

				<!-- Right panel: Dependency details -->
				<div id="dep-details-panel" class="onboarding-deps-details">
					<div class="onboarding-deps-placeholder">
						<p>← Click on a dependency to view details</p>
					</div>
				</div>
			</div>

			<!-- Button layout: All buttons in one line -->
			<div class="onboarding-actions">
				<!-- Left side buttons -->
				<div class="onboarding-actions-left">
					<button id="check-again-btn" class="btn-secondary onboarding-btn">Check Again</button>
					<button id="install-missing-deps-btn" class="btn-primary onboarding-btn" disabled>
						Install Missing
					</button>
				</div>

				<!-- Right side: Next button -->
				<div>
					<button id="onboarding-next-2" class="btn-primary onboarding-btn" disabled>Next →</button>
				</div>
			</div>
		</div>

		<!-- Step 3: Email -->
		<div id="onboarding-step-3" class="onboarding-step" style="display: none">
			<h1>Enter Your Email</h1>
			<p class="onboarding-step-description">
				This will be used to identify your BioVault instance.
			</p>
			<input
				type="email"
				id="onboarding-email"
				class="onboarding-input"
				placeholder="your.email@example.com"
				autocapitalize="off"
			/>
			<div id="email-validation-message" class="onboarding-validation-message"></div>
			<div class="onboarding-nav-buttons">
				<button id="onboarding-back-3" class="btn-secondary onboarding-btn">← Back</button>
				<button id="onboarding-next-3" class="btn-primary onboarding-btn" style="flex: 1">
					Next →
				</button>
			</div>
		</div>

		<!-- Step 3.5: Key Setup -->
		<div id="onboarding-step-3-key" class="onboarding-step" style="display: none">
			<h1>Secure Your Key</h1>
			<p class="onboarding-step-description">
				We use a Syft Crypto key for encryption. You can use an existing key (if found), restore
				from a recovery code, or generate a new one.
			</p>
			<div class="key-card">
				<div class="key-card-left">
					<div id="onboarding-key-avatar" class="key-avatar"></div>
					<div class="key-card-meta">
						<div id="onboarding-key-identity" class="key-identity">Loading...</div>
						<div id="onboarding-key-fp" class="key-fingerprint">—</div>
						<div id="onboarding-key-status" class="key-status-line">Checking vault…</div>
					</div>
				</div>
				<div class="key-card-actions" id="onboarding-key-actions">
					<button id="onboarding-restore-btn" class="btn-secondary">
						Restore from Recovery Code
					</button>
					<button id="onboarding-generate-btn" class="danger-btn">Generate New</button>
				</div>
			</div>
			<div id="onboarding-recovery-block" class="onboarding-recovery-block" style="display: none">
				<div class="onboarding-recovery-header">
					<label>Recovery Code (save securely)</label>
					<button
						id="onboarding-copy-recovery-inline"
						class="copy-inline-btn"
						title="Copy to clipboard"
					>
						<svg
							width="14"
							height="14"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
						>
							<rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
							<path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
						</svg>
					</button>
				</div>
				<pre id="onboarding-recovery-text" class="recovery-box"></pre>
				<label class="recovery-checkbox-label">
					<input type="checkbox" id="onboarding-recovery-ack" />
					<span>I have saved this recovery code; it will not be shown again.</span>
				</label>
				<div class="onboarding-recovery-actions">
					<button id="onboarding-copy-recovery-btn" class="btn-small">Copy Code</button>
					<button id="onboarding-copy-fp-btn" class="btn-small">Copy Fingerprint</button>
					<button id="onboarding-open-vault-btn" class="btn-small">Open Vault</button>
				</div>
			</div>
			<div id="onboarding-restore-block" class="onboarding-restore-block" style="display: none">
				<label>Enter Recovery Code</label>
				<textarea
					id="onboarding-restore-input"
					class="onboarding-textarea"
					rows="3"
					placeholder="Paste your BIP-39 recovery code"
				></textarea>
				<div class="onboarding-restore-actions">
					<button id="onboarding-restore-confirm-btn" class="btn-primary">Restore</button>
					<button id="onboarding-restore-cancel-btn" class="btn-secondary">Cancel</button>
				</div>
			</div>
			<p id="onboarding-key-warning" class="key-warning"></p>
			<div class="onboarding-nav-buttons" style="justify-content: flex-end">
				<button id="onboarding-back-3-key" class="btn-secondary onboarding-btn">← Back</button>
				<button id="onboarding-next-3-key" class="btn-primary onboarding-btn">Next →</button>
			</div>
		</div>

		<!-- Step 4: SyftBox OTP Authentication (Optional) -->
		<div id="onboarding-step-4" class="onboarding-step" style="display: none">
			<div class="onboarding-step-header">
				<h1>SyftBox Authentication</h1>
				<button id="skip-syftbox-btn" class="btn-secondary onboarding-skip-btn">Skip</button>
			</div>
			<!-- Initial state: overview -->
			<div id="syftbox-send-state" style="display: block">
				<div class="onboarding-syftbox-hero">
					<img
						src="assets/bv-syftbox.png"
						alt="BioVault + SyftBox"
						style="max-width: 100%; height: auto; display: block"
					/>
				</div>
				<div class="onboarding-syftbox-info">
					<p>
						<strong>BioVault uses SyftBox for its secure networking capability.</strong>
						Using SyftBox is optional; however, if you want to collaborate with other BioVaults it's
						highly recommended.
					</p>
					<p>It's completely free and open source - just verify your email to get started.</p>
					<p style="margin: 0">
						To read more about SyftBox please visit:
						<a href="#" class="syftbox-link" data-url="https://dev.syftbox.net"
							>https://dev.syftbox.net</a
						>
					</p>
				</div>
				<div class="onboarding-actions" style="justify-content: flex-end">
					<button id="syftbox-info-continue-btn" class="btn-primary onboarding-btn">
						Authenticate SyftBox
					</button>
				</div>
			</div>

			<!-- Email walkthrough before sending code -->
			<div id="syftbox-email-info" style="display: none">
				<p class="onboarding-step-description">
					We'll send a one-time passcode to
					<strong><span id="syftbox-email-preview-address">your email</span></strong
					>. You'll use this code on the next screen to finish linking SyftBox.
				</p>
				<div id="syftbox-email-scroll" class="onboarding-email-preview">
					<p class="onboarding-email-label">Example Email</p>
					<div class="onboarding-email-image-wrap">
						<img
							src="assets/syftbox-email.png"
							alt="SyftBox email preview"
							style="width: 100%; max-height: 500px; object-fit: contain; display: block"
						/>
					</div>
				</div>
				<p class="onboarding-hint">
					Don't close the app - just open your inbox once you click continue, and then enter the
					8-digit code.
				</p>
				<div class="onboarding-nav-buttons" style="justify-content: flex-end">
					<button id="syftbox-email-back-btn" class="btn-secondary onboarding-btn">Back</button>
					<button id="send-login-code-btn" class="btn-primary onboarding-btn">Send Code</button>
				</div>
			</div>

			<!-- OTP Input state -->
			<div id="syftbox-otp-state" style="display: none">
				<div class="onboarding-otp-header">
					<div class="onboarding-otp-email-row">
						<svg width="20" height="20" viewBox="0 0 20 20" fill="#10b981">
							<path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
							<path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
						</svg>
						<span id="syftbox-user-email"></span>
					</div>
					<p>Enter the 8-digit code we emailed to you</p>
				</div>

				<!-- 8-digit code input -->
				<div class="onboarding-otp-inputs">
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="0" />
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="1" />
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="2" />
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="3" />
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="4" />
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="5" />
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="6" />
					<input type="text" class="syftbox-code-input" maxlength="1" data-index="7" />
				</div>

				<!-- Error Message -->
				<div id="syftbox-error-message" class="onboarding-error-message" style="display: none">
					Invalid verification code. Please try again.
				</div>

				<!-- Verify Button -->
				<button
					id="verify-code-btn"
					class="btn-primary onboarding-btn onboarding-btn-full"
					disabled
				>
					Verify Code
				</button>

				<!-- Resend Code -->
				<div class="onboarding-resend">
					<p>Didn't receive the code?</p>
					<button id="resend-code-btn" class="link-button">Send Again</button>
				</div>
			</div>
		</div>

		<!-- Step 5: Initializing -->
		<div id="onboarding-step-5" class="onboarding-step" style="display: none">
			<h1>Initializing BioVault...</h1>
			<div id="init-status" class="onboarding-init-status">
				<div class="spinner" style="width: 40px; height: 40px; margin: 0 auto 20px"></div>
				<p>Please wait...</p>
			</div>
			<div id="init-log" class="onboarding-log" style="display: none"></div>
		</div>
	</div>
</div>

<!-- Installation Progress Modal -->
<div id="install-modal" class="onboarding-modal" style="display: none">
	<div class="onboarding-modal-content">
		<h2>Installing Dependencies</h2>
		<div id="install-progress" class="onboarding-install-progress">
			<div class="onboarding-progress-track">
				<div id="install-progress-bar" class="onboarding-progress-bar"></div>
			</div>
			<p id="install-status-text">Preparing...</p>
		</div>
		<div id="install-log" class="onboarding-log"></div>
		<button
			id="install-close-btn"
			class="btn-secondary onboarding-btn onboarding-btn-full"
			disabled
		>
			Close
		</button>
	</div>
</div>
