<div class="view-container">
	<!-- Page Header -->
	<header class="page-header">
		<div class="page-header-left">
			<h1 class="page-title">SQL Query</h1>
		</div>
		<div class="page-header-right">
			<div class="page-header-actions">
				<button id="sql-refresh-tables-btn" class="btn-secondary">
					<svg
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
					>
						<polyline points="23 4 23 10 17 10"></polyline>
						<path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
					</svg>
					Refresh Tables
				</button>
				<button id="sql-download-btn" class="btn-secondary" disabled>
					<svg
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
					>
						<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
						<polyline points="7 10 12 15 17 10"></polyline>
						<line x1="12" y1="15" x2="12" y2="3"></line>
					</svg>
					Download CSV
				</button>
			</div>
		</div>
	</header>

	<!-- Main Content -->
	<div class="view-content">
		<div class="sql-layout">
			<!-- Left Sidebar: Tables -->
			<div class="sql-sidebar">
				<div class="sql-sidebar-header">
					<h3>Tables</h3>
					<span id="sql-table-count" class="table-count">0</span>
				</div>
				<div class="sql-sidebar-content">
					<ul id="sql-table-list" class="sql-table-list">
						<li class="sql-list-placeholder">
							No tables yet. Import data or run a pipeline with SQL storage.
						</li>
					</ul>
				</div>
				<div id="sql-table-schema" class="sql-table-schema"></div>
			</div>

			<!-- Main Area: Editor and Results -->
			<div class="sql-main">
				<!-- Query Editor -->
				<div class="sql-editor-section">
					<div class="sql-editor-header">
						<h3>Query Editor</h3>
						<div class="sql-editor-actions">
							<button id="sql-format-btn" class="btn-secondary-small">
								<svg
									width="14"
									height="14"
									viewBox="0 0 24 24"
									fill="none"
									stroke="currentColor"
									stroke-width="2"
								>
									<polyline points="16 18 22 12 16 6"></polyline>
									<polyline points="8 6 2 12 8 18"></polyline>
								</svg>
								Format
							</button>
							<button id="sql-run-btn" class="btn-run">
								<svg
									width="12"
									height="12"
									viewBox="0 0 24 24"
									fill="none"
									stroke="currentColor"
									stroke-width="2.5"
								>
									<polygon points="5 3 19 12 5 21 5 3"></polygon>
								</svg>
								Run Query
							</button>
						</div>
					</div>
					<div class="sql-editor-wrapper">
						<pre id="sql-editor-highlight" class="sql-editor-highlight"></pre>
						<textarea
							id="sql-editor-input"
							class="sql-editor-input"
							spellcheck="false"
							placeholder="SELECT * FROM participants LIMIT 10;"
						></textarea>
					</div>
					<div id="sql-status" class="sql-status">
						<svg
							width="14"
							height="14"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
						>
							<circle cx="12" cy="12" r="10"></circle>
							<line x1="12" y1="16" x2="12" y2="12"></line>
							<line x1="12" y1="8" x2="12.01" y2="8"></line>
						</svg>
						<span id="sql-status-text">Ready. Press ⌘+Enter to run query.</span>
					</div>
				</div>

				<!-- Results Table -->
				<div class="sql-results-section">
					<div class="sql-results-header">
						<h3>Results</h3>
						<div id="sql-result-meta" class="sql-result-meta"></div>
					</div>
					<div class="sql-result-table-wrapper">
						<table id="sql-result-table" class="sql-result-table">
							<thead></thead>
							<tbody></tbody>
						</table>
						<div id="sql-result-placeholder" class="sql-result-placeholder">
							<svg
								width="48"
								height="48"
								viewBox="0 0 24 24"
								fill="none"
								stroke="currentColor"
								stroke-width="1.5"
								opacity="0.3"
							>
								<rect x="3" y="3" width="7" height="7"></rect>
								<rect x="14" y="3" width="7" height="7"></rect>
								<rect x="14" y="14" width="7" height="7"></rect>
								<rect x="3" y="14" width="7" height="7"></rect>
							</svg>
							<p style="font-weight: 600; color: #6b7280; margin: 12px 0 4px 0">No results yet</p>
							<p style="font-size: 13px; color: #9ca3af">
								Write a SQL query and press <kbd>⌘+Enter</kbd> or click Run Query
							</p>
						</div>
					</div>
				</div>
			</div>

			<!-- Right Panel: AI Assistant (Optional/Collapsible) -->
			<div class="sql-assistant-panel">
				<details class="sql-assistant-collapsible">
					<summary>
						<svg
							width="18"
							height="18"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
						>
							<path
								d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
							></path>
							<polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
							<line x1="12" y1="22.08" x2="12" y2="12"></line>
						</svg>
						<span>AI Assistant</span>
					</summary>
					<div class="sql-assistant-content">
						<p class="sql-assistant-description">
							Describe what you want to query and the AI will generate SQL for you.
							<br />
							<small style="color: #9ca3af">Configure OpenRouter in Settings to enable.</small>
						</p>
						<textarea
							id="sql-ai-prompt"
							class="sql-ai-prompt"
							placeholder="e.g., Show me all participants with genotype files"
							rows="3"
						></textarea>
						<button id="sql-ai-submit-btn" class="btn-primary" style="width: 100%; margin-top: 8px">
							<svg
								width="14"
								height="14"
								viewBox="0 0 24 24"
								fill="none"
								stroke="currentColor"
								stroke-width="2"
							>
								<path
									d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
								></path>
							</svg>
							Generate SQL
						</button>
						<div id="sql-ai-status" class="sql-ai-status"></div>
						<div id="sql-ai-history" class="sql-ai-history"></div>
					</div>
				</details>
			</div>
		</div>
	</div>
</div>
